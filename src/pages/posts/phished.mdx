---
layout: "../../layouts/MarkdownPostLayout.astro"
title: "Phished â€“ Phish Friends & Family"
pubDate: "Published on November 21, 2022"
image:
  url: "/phished-screenshot.webp"
  alt: "A tablet and smartphone are next to each other, each displaying a screenshot from the Phished website. The Phished logo, a fish with an envelope for a body, is displayed on the right with the Phished wordmark."
---

In September 2022 I was selected to lead a team of seven developers and designers to create Phished, a platform where users are empowered to protect their friends & family from phishing attacks.

Phished was an interdisplinary capstone project between two different programs at BCIT. We used Next.js, Firebase, and Nodemailer. [Click to check it out!](https://phished.up.railway.app/)

<br />
<br />

## Frontend and Authentication

We used the [Mantine component library](https://mantine.dev/) to build out our front-end. Mantine made it easy to integrate theming and custom styling into our web app. To authenticate users we used NextAuth.js (now known as [Auth.js](https://authjs.dev/)) which made it straightforward to setup and connect Phished to OAuth2 and OpenID Connect providers. We chose these tools because they're open-source, TypeScript based, and have great documentation.

Our <code>\_app.jsx</code> document imports providers from Mantine and Auth.js to handle our theming and user sessions.

```js
import { useState } from "react";
import { ColorSchemeProvider, MantineProvider } from "@mantine/core";
import { authOptions } from "./api/auth/[...nextauth]";
import { unstable_getServerSession } from "next-auth";
import { SessionProvider } from "next-auth/react";

export default function App({
  Component,
  pageProps: { session, ...pageProps },
}) {
  const [colorScheme, setColorScheme] = useState("light");

  function toggleColorScheme(value) {
    const nextColorScheme =
      value || (colorScheme === "dark" ? "light" : "dark");
    setColorScheme(nextColorScheme);
  }

  return (
    <>
      <SessionProvider session={session}>
        <ColorSchemeProvider
          colorScheme={colorScheme}
          toggleColorScheme={toggleColorScheme}
        >
          <MantineProvider
            withGlobalStyles
            withNormalizeCSS
            theme={{ colorScheme }}
          >
            <Component {...pageProps} />
          </MantineProvider>
        </ColorSchemeProvider>
      </SessionProvider>
    </>
  );
}
```

<br />

<figure>
  ![A screenshot showing Phished in light and dark
  mode.](/phished/dark-light.jpg)
  <figcaption>
    Mantine makes it easy to implement a light and dark theme.
  </figcaption>
</figure>

<br />
<br />

## Backend and Phishing Emails

Firebase allowed us to easily integrate a real-time database that stores data as JSON and can be accessed directly from the client-side. Along with Firebase's security and data validation tools, we're utilizing their serverless function triggers to send our phishing emails.

To make this project work, we had to figure out how to send (harmless) phishing emails without getting blacklisted or sent to spam. Initially we thought about using AWS SES (Simple Email Service) but that fizzled out when Amazon rejected our application.

After plenty of trial and effort, we ended up using [Nodemailer](https://nodemailer.com/about/), a module for Node.js applications. We use [sendinblue](https://www.sendinblue.com/) as our email service provider and [Handlebars.js](https://handlebarsjs.com/) to create emails. Handlebars is a templating language that allows us to render styled HTML content in an email.

```js
// A phishing email example using Handlebars.js

<body>
  <div id="data"></div>
  <h2>FACEBOOK</h2>
  <hr />
  <p>Hello {{ bodyName }},</p>
  <p>Your Facebook password was changed on {{ datetime }}</p>
  <p>
    <strong>If you did this, </strong>you can safely disregard this email.
  </p>
  <p>
    <strong>If you didn't do this, </strong>please{" "}
    <a href={{ phishedLink }}>secure your account</a>.
  </p>
  <p>Thank you, </p>
  <p>The Facebook Security Team</p>
  <br />
  <br />
  <a href={{ unsubscribeLink }}>Unsubscribe</a>
</body>
```
